@using ecomFront.Models.PricingViewModels
@using ecomFront.Common

@{
    ViewData["Title"] = "Precios";
    Layout = "_Layout";
}
@model HomePricingViewModel
<!-- Page header -->
<div class="page-header page-header-light">
    <div class="page-header-content header-elements-lg-inline">
        <div class="page-title d-flex">
            <a href="#" class="header-elements-toggle text-body d-lg-none"><i class="icon-more"></i></a>
        </div>
        <div class="header-elements d-none">
            <div class="d-flex  order-2 justify-content-center">
                <a asp-area="" asp-controller="Pricing" asp-action="HomePricing" asp-route-executionId="@Model.Execution.IdExecution" class="btn btn-link btn-float font-size-xs font-weight-semibold text-body" style="width:120px">
                    <i class="icon-coin-dollar icon-2x text-teal"></i>
                    <span>Precios</span>
                </a>
                <a asp-area="" asp-controller="Sales" asp-action="HomeSales" asp-route-executionId="@Model.Execution.IdExecution" class="btn btn-link btn-float font-size-xs font-weight-semibold text-body" style="width:120px">
                    <i class="mi-shopping-cart  mi-2x text-teal"></i>
                    <span>Ventas</span>
                </a>
                <a asp-area="" asp-controller="Trend" asp-action="HomeTrend" asp-route-executionId="@Model.Execution.IdExecution" class="btn btn-link btn-float font-size-xs font-weight-semibold text-body" style="width:120px">
                    <i class="mi-trending-up  mi-2x text-teal"></i>
                    <span>Tendencias</span>
                </a>
                <a asp-area="" asp-controller="Seller" asp-action="HomeSellers" asp-route-executionId="@Model.Execution.IdExecution" class="btn btn-link btn-float font-size-xs font-weight-semibold text-body" style="width:120px">
                    <i class="mi-people-outline  mi-2x text-teal"></i>
                    <span>Competidores</span>
                </a>
                <a asp-area="" asp-controller="Listing" asp-action="ListingList" asp-route-executionId="@Model.Execution.IdExecution" class="btn btn-link btn-float font-size-xs font-weight-semibold text-body" style="width:120px">
                    <i class="icon-coin-dollar icon-2x text-teal"></i>
                    <span>PUBLICACIONES</span>
                </a>
            </div>
        </div>
    </div>
    <div class="breadcrumb-line breadcrumb-line-light header-elements-lg-inline">
        <div class="d-flex">
            <div class="breadcrumb">
                <a asp-area="" asp-controller="Home" asp-action="Index" class="breadcrumb-item"><i class="icon-home2 mr-2"></i> Home</a>
                <a asp-area="" asp-controller="Search" asp-action="Searches" class="breadcrumb-item"> Busqueda</a>
                <a asp-area="" asp-controller="Analisis" asp-action="HomeAnalisis" asp-route-executionId="@Model.Execution.IdExecution" class="breadcrumb-item"> @Model.Search.Description</a>
                <span class="breadcrumb-item active">Analisis de Precios</span>
            </div>
            <a href="#" class="header-elements-toggle text-body d-lg-none"><i class="icon-more"></i></a>
        </div>
        <div class="header-elements d-none">
            <div class="breadcrumb justify-content-center">
                <a href="#" class="breadcrumb-elements-item">
                    <i class="icon-comment-discussion mr-2"></i>
                    Necesito Ayuda
                </a>
            </div>
        </div>
    </div>
</div>
<!-- /page header -->
<div class="content">
    <div class="row">
        <div class="col-sm-6 col-lg-6">
            <div class="row">
                <div class="col-md-12">
                    <div class="card  border border-secondary">
                        <div class="card-header bg-transparent header-elements-inline p-2">
                            <h5 class="font-weight-normal mb-0">AGRUPACIÓN POR RANGO DE PRECIO Y MEDIO DE PAGO</h5>
                            <div class="header-elements">
                                <div class="list-icons">
                                    <button data-toggle="modal" data-target="#modal_info_agrup_pagos" class="btn btn-outline-secondary btn-icon border-2 rounded-pill">
                                        <i class="fas fa-info  "></i>
                                    </button>

                                </div>
                            </div>
                        </div>
                        <div class="card-body ">
                            <div id="div_scatter_punch_Grouping_mp" class="card-body">
                                <div class="chart-container">
                                    <div class="chart has-fixed-height" id="scatter_punch_Grouping_mp" style="-webkit-tap-highlight-color: transparent; user-select: none; position: relative;">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
        </div>
        <div class="col-sm-6 col-lg-6">
            <div class="row">
                <div class="col-md-12">
                    <div class="card  border border-secondary">
                        <div class="card-header bg-transparent header-elements-inline p-2">
                            <h5 class="font-weight-normal mb-0">AGRUPACIÓN POR RANGO DE PRECIO Y FORMA DE ENVÍO</h5>
                            <div class="header-elements">
                                <div class="list-icons">
                                    <button data-toggle="modal" data-target="#modal_info_agrup_envios" class="btn btn-outline-secondary btn-icon border-2 rounded-pill">
                                        <i class="fas fa-info  "></i>
                                    </button>

                                </div>
                            </div>
                        </div>
                        <div class="card-body ">
                            <div id="div_scatter_punch_Grouping_mp" class="card-body">
                                <div class="chart-container">
                                    <div class="chart has-fixed-height" id="scatter_punch_Grouping_fe" style="-webkit-tap-highlight-color: transparent; user-select: none; position: relative;">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-sm-12 col-lg-12">
            <div class="row">
                <div class="col-md-12">
                    <div class="card  border border-secondary">
                        <div class="card-header bg-transparent header-elements-inline p-2">
                            <h5 class="font-weight-normal mb-0">HISTORIAL PRECIO DE VENTO</h5>
                            <div class="header-elements">
                                <div class="list-icons">
                                    <button data-toggle="modal" data-target="#modal_info_precio_medio_diario" class="btn btn-outline-secondary btn-icon border-2 rounded-pill">
                                        <i class="fas fa-info  "></i>
                                    </button>

                                </div>
                            </div>
                        </div>
                        <div class="card-body ">
                            <div id="div_price_purchase_day" class="card-body">
                                <div class="chart-container">
                                    <div class="chart has-fixed-height" id="line_zoom" _echarts_instance_="ec_1628826304003" style="-webkit-tap-highlight-color: transparent; user-select: none; position: relative;">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-sm col-xl">
            <div class="row">
                <div class="col-md-12">
                    <div class="card  border border-secondary">
                        <div class="card-header bg-transparent header-elements-inline p-2">
                            <h5 class="font-weight-normal mb-0">PUBLICACIONES Y VENTAS POR RANGO DE PRECIO</h5>
                            <div class="header-elements">
                                <div class="list-icons">
                                    <button data-toggle="modal" data-target="#modal_info_cantidad_por_rango_precio" class="btn btn-outline-secondary btn-icon border-2 rounded-pill">
                                        <i class="fas fa-info  "></i>
                                    </button>

                                </div>
                            </div>
                        </div>
                        <div class="card-body ">
                            <div id="singleAxisScatter" style="height:200px;"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div id="modal_info_agrup_envios" class="modal fade" tabindex="-1" aria-hidden="true" style="display: none;">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-body">
                <div id="carouselExampleIndicators1" class="carousel slide" data-ride="carousel">
                    <ol class="carousel-indicators">
                        <li data-target="#carouselExampleIndicators1" data-slide-to="0" class="active"></li>
                    </ol>
                    <div class="carousel-inner">
                        <div class="carousel-item active">
                            <img class="d-block w-100" src="~/global_assets/images/ayuda/agrup-envio-1.png" alt="First slide">
                        </div>
                    </div>
                    <a class="carousel-control-prev" href="#carouselExampleIndicators1" role="button" data-slide="prev">
                        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                        <span class="sr-only">Previous</span>
                    </a>
                    <a class="carousel-control-next" href="#carouselExampleIndicators1" role="button" data-slide="next">
                        <span class="carousel-control-next-icon" aria-hidden="true"></span>
                        <span class="sr-only">Next</span>
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>
<div id="modal_info_agrup_pagos" class="modal fade" tabindex="-1" aria-hidden="true" style="display: none;">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-body">
                <div id="carouselExampleIndicators2" class="carousel slide" data-ride="carousel">
                    <ol class="carousel-indicators">
                        <li data-target="#carouselExampleIndicators2" data-slide-to="0" class="active"></li>
                    </ol>
                    <div class="carousel-inner">
                        <div class="carousel-item active">
                            <img class="d-block w-100" src="~/global_assets/images/ayuda/agrup-pago-1.png" alt="First slide">
                        </div>
                    </div>
                    <a class="carousel-control-prev" href="#carouselExampleIndicators2" role="button" data-slide="prev">
                        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                        <span class="sr-only">Previous</span>
                    </a>
                    <a class="carousel-control-next" href="#carouselExampleIndicators2" role="button" data-slide="next">
                        <span class="carousel-control-next-icon" aria-hidden="true"></span>
                        <span class="sr-only">Next</span>
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>
<div id="modal_info_precio_medio_diario" class="modal fade" tabindex="-1" aria-hidden="true" style="display: none;">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-body">
                <div id="carouselExampleIndicators3" class="carousel slide" data-ride="carousel">
                    <ol class="carousel-indicators">
                        <li data-target="#carouselExampleIndicators3" data-slide-to="0" class="active"></li>
                        <li data-target="#carouselExampleIndicators3" data-slide-to="1"></li>
                    </ol>
                    <div class="carousel-inner">
                        <div class="carousel-item active">
                            <img class="d-block w-100" src="~/global_assets/images/ayuda/precio-medio-venta-1.png" alt="First slide">
                        </div>
                        <div class="carousel-item">
                            <img class="d-block w-100" src="~/global_assets/images/ayuda/precio-medio-venta-2.png" alt="Second slide">
                        </div>
                    </div>
                    <a class="carousel-control-prev" href="#carouselExampleIndicators3" role="button" data-slide="prev">
                        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                        <span class="sr-only">Previous</span>
                    </a>
                    <a class="carousel-control-next" href="#carouselExampleIndicators3" role="button" data-slide="next">
                        <span class="carousel-control-next-icon" aria-hidden="true"></span>
                        <span class="sr-only">Next</span>
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>
<div id="modal_info_cantidad_por_rango_precio" class="modal fade" tabindex="-1" aria-hidden="true" style="display: none;">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-body">
                <div id="carouselExampleIndicators4" class="carousel slide" data-ride="carousel">
                    <ol class="carousel-indicators">
                        <li data-target="#carouselExampleIndicators4" data-slide-to="0" class="active"></li>
                    </ol>
                    <div class="carousel-inner">
                        <div class="carousel-item active">
                            <img class="d-block w-100" src="~/global_assets/images/ayuda/publicaciones-ventas-1.png" alt="First slide">
                        </div>
                    </div>
                    <a class="carousel-control-prev" href="#carouselExampleIndicators4" role="button" data-slide="prev">
                        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                        <span class="sr-only">Previous</span>
                    </a>
                    <a class="carousel-control-next" href="#carouselExampleIndicators4" role="button" data-slide="next">
                        <span class="carousel-control-next-icon" aria-hidden="true"></span>
                        <span class="sr-only">Next</span>
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="~/assets/js/PricingCharts.js"></script>
@section Scripts
    {
    <script type="text/javascript">
        document.addEventListener('DOMContentLoaded', function () {
            //var xList = ['menos 10', '20 - 30', '30 - 40', '40-50', '60 - 70', '80 - 90', 'mas 90'];
            //var yList = ['Cuotas\n s/Interes', 'Cuotas \nc/Interes \n(comision)', 'Cuotas \nc/Interes \n(s/comision)'];
            //var data = [
            //    [0, 0, 70], [0, 1, 10], [0, 2, 6], [0, 3, 16], [0, 4, 16], [0, 5, 5], [0, 6, 36], [0, 7, 42], [0, 8, 28], [0, 9, 60],
            //    [1, 0, 15], [1, 1, 10], [1, 2, 6], [1, 3, 16], [1, 4, 16], [1, 5, 5], [1, 6, 36], [1, 7, 42], [1, 8, 28], [1, 9, 35],
            //    [2, 0, 15], [2, 1, 10], [2, 2, 6], [2, 3, 16], [2, 4, 16], [2, 5, 5], [2, 6, 36], [2, 7, 42], [2, 8, 28], [2, 9, 80],
            //];
            //var xName = 'Nombre X';
            //var yName = 'Nombre Y';
            //var dataName = 'Datos';
            //var itemColor = colores[Math.floor(Math.random() * 5)];

            //_scatterPunchLightExample('scatter_punch_PaymentMethod', xList, xName, yList, yName, data, dataName, itemColor);

            //var xList2 = ['menos 10', '20 - 30', '30 - 40', '40-50', '60 - 70', '80 - 90', 'mas 90'];
            //var yList2 = ['Envio \n Gratis', 'Acordar \ncon el \nvendedor', 'Correo', 'Mercado \n Envios'];
            //var data2 = [
            //    [0, 0, 45],[0, 1, 6],[0, 2, 17],[0, 3, 0],[0, 4, 23],[0, 5, 60],[0, 6, 54],[0, 7, 30],[0, 8, 17],[0, 9, 41],[1, 0, 3],[1, 1, 11],[1, 2, 53],[1, 3, 51],[1, 4, 17],[1, 5, 13],[1, 6, 5],[1, 7, 43],
            //    [1, 8, 39],[1, 9, 48],[2, 0, 38],[2, 1, 39],[2, 2, 19],[2, 3, 27],[2, 4, 39],[2, 5, 16],[2, 6, 9],[2, 7, 3],[2, 8, 51],[2, 9, 46],[3, 0, 15],[3, 1, 59],[3, 2, 25],[3, 3, 27],[3, 4, 34],[3, 5, 26],[3, 6, 7],[3, 7, 6],[3, 8, 41],[3, 9, 48]
            //];
            //var xName2 = 'Nombre X';
            //var yName2 = 'Nombre Y';
            //var dataName2 = 'Datos';
            //var itemColor2 = colores[Math.floor(Math.random() * 5)];

            //_scatterPunchLightExample('scatter_punch_ShippingMethod', xList2, xName2, yList2, yName2, data2, dataName2, itemColor2);

            $('#div_scatter_punch_Grouping_mp').addClass('loader');
            $('#div_scatter_punch_Grouping_fe').addClass('loader');
            $('#div_price_purchase_day').addClass('loader');

            _showGroupingPriceInfoMP();
            _showGroupingPriceInfoFE();
            _showPurchasePricePerDayInfo();
            _singleAxisScatter();
            $('#sidebar-toggle').click();

        });

        var _singleAxisScatter = function (element, size) {
            $.post('/Pricing/GetCantidadPorRango', { executionId: @Model.Execution.IdExecution })
                .done(function (data) {
                    _SingleAxisScatterChart("singleAxisScatter", JSON.parse(data.dataPublicaciones), JSON.parse(data.dataVentas), data.xList, data.maxValuePublicaciones, data.maxValueVentas);
                })
                .fail(function (e) {
                    $.jGrowl(e.responseText, { theme: 'growl-error', header: ' ERROR ', life: 3000 });
                });
        }
        var _showGroupingPriceInfoMP = function (element, size) {
            $.post('/Pricing/GetGroupingPriceMP', { executionId: @Model.Execution.IdExecution })
                .done(function (data) {
                    $('#div_scatter_punch_Grouping_mp').removeClass('loader');
                    _scatterPlotGroupingPrice('scatter_punch_Grouping_mp', data.xList, data.xName, data.yList, data.yName, JSON.parse(data.data), data.dataName, data.minValue, data.maxValue, "Medio-De-Pago");
                })
                .fail(function (e) {
                    $.jGrowl(e.responseText, { theme: 'growl-error', header: ' ERROR ', life: 3000 });
                });
        }

        var _showGroupingPriceInfoFE = function (element, size) {
            $.post('/Pricing/GetGroupingPriceFE', { executionId: @Model.Execution.IdExecution })
                .done(function (data) {
                    $('#div_scatter_punch_Grouping_fe').removeClass('loader');
                    _scatterPlotGroupingPrice('scatter_punch_Grouping_fe', data.xList, data.xName, data.yList, data.yName, JSON.parse(data.data), data.dataName, data.minValue, data.maxValue, "Forma-Envio");
                })
                .fail(function (e) {
                    $.jGrowl(e.responseText, { theme: 'growl-error', header: ' ERROR ', life: 3000 });
                });
        }

         var _showPurchasePricePerDayInfo = function (element, size) {
            $.post('/Pricing/GetPricePerDayInfo', { executionId: @Model.Execution.IdExecution })
                .done(function (data) {
                    $('#div_price_purchase_day').removeClass('loader');
                    _purchasePricePerDayInfo('line_zoom', data.dates, data.prices);
                })
                .fail(function (e) {
                    $.jGrowl(e.responseText, { theme: 'growl-error', header: ' ERROR ', life: 3000 });
                });
        }

    </script>
}